"use strict";(self.webpackChunkjustpasteit=self.webpackChunkjustpasteit||[]).push([[159],{29247:function(e,t,i){var n=i(67294),s=i(20745),r=i(9669),a=i.n(r),l=i(25164),o=i(25108);window.unreadMessagesCount=null,window.unreadSharedArticlesCount=null,window.unreadSubscribedArticlesCount=null;var d=i(88581),u=i(25108);function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends n.Component{constructor(e){super(e),c(this,"options",void 0),c(this,"wrapperRef",void 0),c(this,"visibilityApi",void 0),c(this,"refreshUnreadInterval",5e3),this.options=window.mainPanelOptions,this.state={submenuOpen:!1,dropdownOpen:!1,unreadMessages:0,unreadSharedArticles:0,unreadSubscribedArticles:0},this.handlePhoneAccountButtonClick=this.handlePhoneAccountButtonClick.bind(this),this.handleDesktopAccountButtonClick=this.handleDesktopAccountButtonClick.bind(this),this.handleLogoutClick=this.handleLogoutClick.bind(this),this.setWrapperRef=this.setWrapperRef.bind(this),this.handleClickOutside=this.handleClickOutside.bind(this),this.refreshUnreadMessages=this.refreshUnreadMessages.bind(this),this.visibilityApi=new d.Z}componentDidMount(){document.addEventListener("mousedown",this.handleClickOutside),this.options.isLoggedIn&&this.startUnreadMessagesSync()}async startUnreadMessagesSync(){await this.updateUnreadCount(!1),this.visibilityApi.isSupported()&&this.visibilityApi.installHook(),this.visibilityApi.setEveryVisibility(this.refreshUnreadMessages,this.refreshUnreadInterval)}refreshUnreadMessages(){this.updateUnreadCount(!0)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}render(){return n.createElement(n.Fragment,null,n.createElement("a",{href:this.options.addArticleUrl,className:"d-flex align-items-center col text-decoration-none"},n.createElement("img",{src:this.options.logoUrl,width:"160px",height:"50px",alt:"JustPaste.it"})),n.createElement("div",{className:"col-auto text-end mainTableTopButtons"},n.createElement("div",{className:"d-inline-block d-lg-none"},this.renderPhoneMenu()),n.createElement("div",{className:"d-none d-lg-inline-block btn-group"},this.renderDesktopMainButtons(),this.renderDesktopAccountButton())),this.renderSubmenu())}renderDesktopMainButtons(){return this.options.isLoggedIn?n.createElement(n.Fragment,null,n.createElement("a",{href:this.options.addArticleUrl,className:"btn btn-danger btn-sm topHeaderButtons"},n.createElement("i",{className:"bi bi-pencil-square topBarIcon"})," Add"),n.createElement("a",{href:this.options.manageAccountUrl,className:"btn btn-danger btn-sm topHeaderButtons"},n.createElement("i",{className:"bi bi-card-checklist topBarIcon"})," Notes"),n.createElement("a",{href:this.options.messagesUrl,className:"btn btn-danger btn-sm topHeaderButtons"},n.createElement("i",{className:"bi bi-chat-left-text topBarIcon"})," Messages ",this.renderSubMessagesUnread()),n.createElement("a",{href:this.options.subscribedArticlesUrl,className:"btn btn-danger btn-sm topHeaderButtons"},n.createElement("i",{className:"bi bi-bell topBarIcon"})," Subscribed ",this.renderSubscribedArticlesUnread()),n.createElement("a",{href:this.options.sharedArticlesUrl,className:"btn btn-danger btn-sm topHeaderButtons"},n.createElement("i",{className:"bi bi-share topBarIcon"})," Shared with you ",this.renderSubSharedArticlesUnread())):n.createElement("a",{href:this.options.addArticleUrl,className:"btn btn-danger btn-sm topHeaderButtons"},n.createElement("i",{className:"bi bi-pencil-square topBarIcon"})," Add")}setWrapperRef(e){this.wrapperRef=e}handleClickOutside(e){this.wrapperRef&&this.state.dropdownOpen&&(this.wrapperRef.contains(e.target)||this.setState({dropdownOpen:!1}))}async updateUnreadCount(e){const[t,i,n]=await class{static async get(e,t){if(!t&&null!==window.unreadMessagesCount&&-1!==window.unreadMessagesCount)return[window.unreadMessagesCount,window.unreadSharedArticlesCount,window.unreadSubscribedArticlesCount];if(-1===window.unreadMessagesCount){do{await(0,l.Z)(500)}while(-1===window.unreadMessagesCount);if(!t&&null!==window.unreadMessagesCount)return[window.unreadMessagesCount,window.unreadSharedArticlesCount,window.unreadSubscribedArticlesCount]}window.unreadMessagesCount=-1;try{const t=await a().get(e,{withCredentials:!0,validateStatus:e=>200===e});if(200===t.status){const e=t.data;return window.unreadMessagesCount=e.unreadMessages,window.unreadSharedArticlesCount=e.unreadSharedArticles,window.unreadSubscribedArticlesCount=e.unreadSubscribedArticles,[window.unreadMessagesCount,window.unreadSharedArticlesCount,window.unreadSubscribedArticlesCount]}o.error("Wrong response status: "+t.status)}catch(e){o.error(e)}return window.unreadMessagesCount=null,window.unreadSharedArticlesCount=null,window.unreadSubscribedArticlesCount=null,[null,null,null]}}.get(this.options.unreadMessagesUrl,e);null!==t&&this.setState({unreadMessages:t}),null!==i&&this.setState({unreadSharedArticles:i}),null!==n&&this.setState({unreadSubscribedArticles:n})}renderPhoneMenu(){return this.options.isLoggedIn?n.createElement(n.Fragment,null,n.createElement("a",{className:"btn btn-danger btn-sm topUserBtn topHeaderButtons",rel:"nofollow",onClick:this.handlePhoneAccountButtonClick},n.createElement("img",{src:window.mainPanelOptions.userAvatar,className:"topUserAvatar rounded-circle",alt:"Avatar",width:20,height:20})," ",n.createElement("span",{className:"topUserBtnText"},n.createElement("span",{className:"d-none d-sm-inline"},this.renderShortUserName())," ",this.renderUnreadMessagesBadge()),n.createElement("span",{className:"topUserBtnText topUserBtnList"},n.createElement("i",{className:"bi bi-list"})))):n.createElement("div",{className:"btn-group"},this.renderGuestAddNoteButton(),this.renderGuestAccountButton())}renderGuestAddNoteButton(){return n.createElement("a",{href:this.options.addArticleUrl,className:"btn btn-danger btn-sm topHeaderButtons"},n.createElement("i",{className:"bi bi-pencil-square topBarIcon"})," Add")}renderGuestAccountButton(){return n.createElement("a",{className:"btn btn-sm btn-danger topHeaderButtons",rel:"nofollow",href:this.options.loginUrl},n.createElement("i",{className:"bi bi-person-square topBarIcon"})," ","Account")}renderDesktopAccountButton(){return this.options.isLoggedIn?n.createElement("div",{ref:this.setWrapperRef,className:"btn-group dropdown"},n.createElement("a",{className:"btn btn-danger btn-sm dropdown-toggle topUserBtn topHeaderButtons "+(this.state.dropdownOpen?"show":""),rel:"nofollow","data-bs-toggle":"dropdown",onClick:this.handleDesktopAccountButtonClick},n.createElement("img",{src:window.mainPanelOptions.userAvatar,className:"topUserAvatar rounded-circle",alt:"Avatar",width:20,height:20})," ",n.createElement("span",{className:"topUserBtnText"},n.createElement("span",{className:"d-none d-sm-inline"},this.renderShortUserName()))),n.createElement("ul",{className:"dropdown-menu dropDownButtons "+(this.state.dropdownOpen?"show dropDownOpen":"")},this.renderPublicProfileLink(),n.createElement("li",null,n.createElement("a",{href:this.options.articlesStatsUrl,className:"dropdown-item"},n.createElement("i",{className:"bi bi-bar-chart-line d-none d-sm-inline"})," ",n.createElement("span",{className:"d-none d-sm-inline"},"Notes statistics"),n.createElement("span",{className:"d-inline d-sm-none"},"Statistics"))),n.createElement("li",null,n.createElement("a",{href:this.options.favouriteArticlesUrl,className:"dropdown-item"},n.createElement("i",{className:"bi bi-star d-none d-sm-inline"})," Favourite ",n.createElement("span",{className:"d-none d-sm-inline"},"notes"))),n.createElement("li",null,n.createElement("a",{href:this.options.trashUrl,className:"dropdown-item"},n.createElement("i",{className:"bi bi-trash d-none d-sm-inline"})," Trash")),n.createElement("li",null,n.createElement("a",{href:this.options.profileSettings,className:"dropdown-item"},n.createElement("i",{className:"bi bi-sliders d-none d-sm-inline"}),"  Settings")),n.createElement("li",null,n.createElement("a",{href:this.options.premiumUrl,className:"dropdown-item"},n.createElement("i",{className:"bi bi-gem d-none d-sm-inline"})," Premium")),n.createElement("li",null,n.createElement("hr",{className:"dropdown-divider"})),n.createElement("li",null,n.createElement("a",{href:"#",onClick:this.handleLogoutClick,className:"dropdown-item"},n.createElement("i",{className:"bi bi-box-arrow-right d-none d-sm-inline"})," Logout")))):this.renderGuestAccountButton()}rToRoute(e){location.href=e}renderSubmenu(){return this.state.submenuOpen?n.createElement("div",{className:"col-12 list-group topSubmenu"},this.renderSubmenuItem("add",this.options.addArticleUrl,"bi-pencil-square",n.createElement(n.Fragment,null,"Add note")),this.renderSubmenuItem("manage",this.options.manageAccountUrl,"bi-card-checklist",n.createElement(n.Fragment,null,"Your notes")),this.renderSubmenuItem("stats",this.options.articlesStatsUrl,"bi-bar-chart-line",n.createElement(n.Fragment,null,"Notes statistics")),this.renderSubmenuItem("messages",this.options.messagesUrl,"bi-chat-left-text",n.createElement(n.Fragment,null,"Messages ",this.renderSubMessagesUnread())),this.renderSubmenuItem("subscribed",this.options.subscribedArticlesUrl,"bi-bell",n.createElement(n.Fragment,null,"Subscribed ",this.renderSubscribedArticlesUnread())),this.renderSubmenuItem("favourites",this.options.favouriteArticlesUrl,"bi-star",n.createElement(n.Fragment,null,"Favourite notes")),this.renderSubmenuItem("shared",this.options.sharedArticlesUrl,"bi-share",n.createElement(n.Fragment,null,"Shared with you ",this.renderSubSharedArticlesUnread())),this.renderSubmenuItem("trash",this.options.trashUrl,"bi-trash",n.createElement(n.Fragment,null,"Trash")),this.renderSubmenuItem("settings",this.options.profileSettings,"bi-sliders",n.createElement(n.Fragment,null,"Settings")),this.renderSubmenuItem("subscription",this.options.premiumUrl,"bi-gem",n.createElement(n.Fragment,null,"Premium")),this.renderSubmenuPublicProfileLink(),n.createElement("a",{href:"#",onClick:this.handleLogoutClick,className:"list-group-item"},n.createElement("i",{className:"bi bi-box-arrow-right"})," Logout")):null}renderSubmenuPublicProfileLink(){return null!==this.options.userPermalink&&this.options.userProfileIsPublic?this.renderSubmenuItem("publicProfile",this.options.userProfileLink,"bi-person-square",n.createElement(n.Fragment,null,"Public profile")):null}renderSubmenuItem(e,t,i,s){var r,a;const l=(null===(r=window)||void 0===r||null===(a=r.tabsData)||void 0===a?void 0:a.activeTab)===e;return n.createElement("a",{href:t,className:"list-group-item "+(l?"active":"")},n.createElement("i",{className:"bi "+i})," ",s)}renderUnreadMessagesBadge(){const e=this.state.unreadMessages+this.state.unreadSharedArticles;return 0===e?null:n.createElement("span",{className:"badge bg-warning text-dark"},e)}renderSubMessagesUnread(){return 0===this.state.unreadMessages?null:n.createElement("span",{className:"badge bg-warning text-dark"},this.state.unreadMessages)}renderSubSharedArticlesUnread(){return 0===this.state.unreadSharedArticles?null:n.createElement("span",{className:"badge bg-warning text-dark"},this.state.unreadSharedArticles)}renderSubscribedArticlesUnread(){return 0===this.state.unreadSubscribedArticles?null:n.createElement("span",{className:"badge bg-warning text-dark"},this.state.unreadSubscribedArticles)}async handleLogoutClick(){try{await a().post(this.options.logoutUrl)}catch(e){u.error(e)}location.href=this.options.addArticleUrl}renderPublicProfileLink(){return null!==this.options.userPermalink&&this.options.userProfileIsPublic?n.createElement(n.Fragment,null,n.createElement("li",null,n.createElement("a",{className:"dropdown-item",href:this.options.userProfileLink},n.createElement("span",{className:"d-none d-sm-inline"},n.createElement("i",{className:"bi bi-person-square"})," Public profile"),n.createElement("span",{className:"d-inline d-sm-none"},"Profile"))),n.createElement("li",null,n.createElement("hr",{className:"dropdown-divider"}))):null}handlePhoneAccountButtonClick(){this.setState({submenuOpen:!this.state.submenuOpen})}handleDesktopAccountButtonClick(){this.setState({dropdownOpen:!this.state.dropdownOpen})}renderShortUserName(){let e=this.options.userPermalink;if(null!==e)return e.length>16&&(e=e.substr(0,12)+"..."),e;let t=this.options.userEmail;if(t.length>16){const e=t.split("@");t=e[0],t.length>16&&(t=t.substr(0,12)+"...")}return t}}var m=i(65912);!async function(){const e=await(0,m.Z)("mainPanelButtons");(0,s.createRoot)(e).render(n.createElement(n.StrictMode,null,n.createElement(h,e.dataset)))}()},88581:function(e,t){function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var n;!function(e){e.Visible="visible",e.Hidden="hidden",e.Prerender="prerender",e.Unloaded="unloaded"}(n||(n={}));t.Z=class{constructor(){if(i(this,"isEnabled",void 0),i(this,"hiddenName",void 0),i(this,"visibilityChangeName",void 0),i(this,"isHidden",void 0),i(this,"visibilityStateSupported",void 0),i(this,"visibilityTimer",null),i(this,"visibilityTimerInterval",100),i(this,"everyVisibilityHook",void 0),i(this,"everyVisibilityInterval",void 0),i(this,"everyVisibilityIntervalCountdown",void 0),i(this,"visibilityTime",0),void 0===document.addEventListener)return void(this.isEnabled=!1);let e,t;if(this.visibilityStateSupported=void 0!==document.visibilityState,void 0!==document.hidden)e="hidden",t="visibilitychange";else if(void 0!==document.msHidden)e="msHidden",t="msvisibilitychange";else{if(void 0===document.webkitHidden)return void(this.isEnabled=!1);e="webkitHidden",t="webkitvisibilitychange"}this.isEnabled=!0,this.hiddenName=e,this.visibilityChangeName=t,this.handleVisibilityChange=this.handleVisibilityChange.bind(this),this.startVisibilityTimerTick=this.startVisibilityTimerTick.bind(this)}installHook(){this.isSupported()&&(void 0!==document.onvisibilitychange?document.onvisibilitychange=this.handleVisibilityChange:document.addEventListener(this.visibilityChangeName,this.handleVisibilityChange,!1),this.startVisibilityTimer())}setEveryVisibility(e,t){this.everyVisibilityHook=e,this.everyVisibilityInterval=t,this.resetEveryVisibilityIntervalCountdown()}isVisible(){return!this.isHidden}resetEveryVisibilityIntervalCountdown(){this.everyVisibilityIntervalCountdown=this.everyVisibilityInterval}stopVisibilityTimer(){null!==this.visibilityTimer&&(clearTimeout(this.visibilityTimer),this.visibilityTimer=null)}isSupported(){return this.isEnabled}handleVisibilityChange(){document[this.hiddenName]?this.onHidden():this.visibilityStateSupported&&document.visibilityState!==n.Visible||this.onVisible()}startVisibilityTimerTick(){this.visibilityTime+=this.visibilityTimerInterval,this.everyVisibilityIntervalCountdown-=this.visibilityTimerInterval,void 0!==this.everyVisibilityHook&&this.everyVisibilityIntervalCountdown<=0&&(this.resetEveryVisibilityIntervalCountdown(),this.everyVisibilityHook()),this.startVisibilityTimer()}onHidden(){this.isHidden=!0,this.stopVisibilityTimer()}onVisible(){this.isHidden=!1,this.resetEveryVisibilityIntervalCountdown(),this.startVisibilityTimer()}startVisibilityTimer(){this.visibilityTimer=setTimeout(this.startVisibilityTimerTick,this.visibilityTimerInterval)}}},25164:function(e,t){t.Z=e=>new Promise((t=>setTimeout(t,e)))},65912:function(e,t,i){var n=i(25164);t.Z=async e=>{let t=null;do{t=document.getElementById(e),null===t&&await(0,n.Z)(100)}while(null===t);return t}},20745:function(e,t,i){var n=i(73935);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot}},function(e){e.O(0,[3935,9669],(function(){return t=29247,e(e.s=t);var t}));e.O()}]);